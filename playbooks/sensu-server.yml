- name: Install and configure the Sensu server
  hosts: monitoring
  become: yes
  become_user: root
  tasks:
    - name: Set up prerequisites
      include_role:
        name: "prereqs"
      static: no

    - name: Set up RabbitMQ
      include_role:
        name: "rabbitmq/server"
      static: no

    - name: Set up Redis
      include_role:
        name: "redis/server"
      static: no

    - name: Set up Sensu Server
      include_role:
        name: "sensu/server"
      static: no

    - name: Set up Uchiwa
      include_role:
        name: "uchiwa/server"
      static: no

    - name: Set up Uchiwa Proxy
      include_role:
        name: "uchiwa/proxy"
      static: no

    - name: Set up Sensu Client
      include_role:
        name: "sensu/client"
      static: no

    - name: Set up RDO Sensu monitoring
      include_role:
        name: "rdo-infra/sensu-client"
      static: no